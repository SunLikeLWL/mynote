# 第10讲：怎么复用你的代码？


### ES6模块

1、ES模块强制自动采取严格模式

2、在对应的script标签中将属性type值设置为module，才能正确地解析为ES6模块

3、在Node.js下使用ES6模块则需要将文件名后缀改为.mjs,用来和Node.js默认使用的Commonjs模块规范作区分


### 特性

ES6 模块有两个重要特性一定要掌握，一个是值引用，另一个是静态声明。

1、值引用


2、静态声明




### import()

1、违反首部声明要求，那么就意味着可以在代码运行时按需加载模块，这个特性就可以用于首屏优化，根据路由和组件只加载依赖的模块。

2、违反变量或表达式要求，则意味着可以根据参数动态加载模块。

3、违反嵌入语句逻辑规则，可想象空间更大，比如可以通过 Promise.race 方式同时加载多个模块，选择加载速度最优模块来使用，从而提升性能。



### Commonjs

定义与引用

1、id 模块的识别符，通常是带有绝对路径的模块文件名；

2、filename 模块的文件名，带有绝对路径；

3、loaded 返回一个布尔值，表示模块是否已经完成加载；

4、parent 返回一个对象，表示调用该模块的模块；

5、children 返回一个数组，表示该模块要用到的其他模块；

6、exports 表示模块对外输出的值。


### 特点

CommonJS 特性和 ES6 恰恰相反，它采用的是值拷贝和动态声明。值拷贝和值引用相反，一旦输出一个值，模块内部的变化就影响不到这个值了，可以简单地理解为变量深拷贝


### AMD

定义与引用

AMD 规范只定义了一个全局函数 define，通过它就可以定义和引用模块，它有 3 个参数：

define(id?, dependencies?, factory);


特性：

它的重要特性就是异步加载。所谓异步加载，就是指同时并发加载所依赖的模块，
当所有依赖模块都加载完成之后，再执行当前模块的回调函数。
这种加载方式和浏览器环境的性能需求刚好吻合。



### CMD

CMD（Common Module Definition，通用模块定义）是基于浏览器环境制定的模块规范。


特性：

它整合了 CommonJS 和 AMD 规范的特点。遵循 CMD 规范的代表开源项目是 sea.js ，它的实现和 requirejs 没有本质差别，有兴趣的同学可以看其源码。





### UMD

UMD（Universal Module Definition，统一模块定义）其实并不是模块管理规范，而是带有前后端同构思想的模块封装工具

1、先判断是否支持 Node.js 模块格式（exports 是否存在），存在则使用 Node.js 模块格式；

2、再判断是否支持 AMD（define 是否存在），存在则使用 AMD 方式加载模块；

3、若前两个都不存在，则将模块公开到全局（Window 或 Global）。